<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Carnicer√≠a Pochito{% endblock %}</title>
    
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fuente y estilos globales para aspecto m√°s profesional -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root{
            --bg: #f7f7f7;
            --primary: #ef4444; /* red-500 */
            --accent-start: #fda4af; /* pink-300 */
            --accent-end: #dc2626; /* red-600 */
            --muted: #6b7280;
            --card: #ffffff;
            --text: #111827;
        }
        /* Dark mode variables (override when body has .dark) */
        body.dark{
            /* user requested true black background and white text */
            --bg: #000000;
            --card: #0b0b0b;
            --text: #ffffff;
            --muted: #cbd5e1;
            --accent-start: #ef4444;
            --accent-end: #f97316;
        }

        html,body{font-family: 'Poppins', Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background: var(--bg); color: var(--text);}
    .toggle-switch { position: relative; display: inline-block; width: 50px; height: 24px; background-color: #e5e7eb; border-radius: 20px; cursor: pointer; transition: background-color 0.3s; border: 1px solid #d1d5db; }
    .toggle-switch.dark { background-color: #334155; border: 1px solid #475569; }
        .toggle-switch::after { content: ''; position: absolute; width: 20px; height: 20px; border-radius: 50%; background-color: white; top: 1px; left: 1px; transition: transform 0.3s; }
        .toggle-switch.active::after { transform: translateX(26px); }
        /* Header / footer tweaks */
    header.site-header{ background: var(--card); border-bottom: 1px solid rgba(226,232,240,0.6); }
        .site-logo{ color: var(--primary); letter-spacing: 0.6px; }
        nav .nav-link{ color: #374151; padding: .6rem .5rem; transition: color .15s; }
        nav .nav-link:hover{ color: var(--primary); }
    footer.site-footer{ background: linear-gradient(180deg,#0f1724,#020617); color: #e6edf3; }
        .card-soft{ background: var(--card); border-radius: 12px; box-shadow: 0 6px 18px rgba(15,23,42,0.06); }
        .btn-primary{ background: linear-gradient(90deg,var(--accent-start),var(--accent-end)); color: white; }
        /* responsive small tweaks */
        @media (max-width:640px){ .site-logo{ font-size:1.25rem } }
    </style>

    <style>
        /* Forzar color de letra seg√∫n modo: negro en light, blanco en dark */
        body.light * {
            color: #000000 !important;
        }
        body.dark * {
            color: #ffffff !important;
        }

        /* Asegurar que botones primarios mantengan texto blanco */
        .btn-primary, .btn-primary * {
            color: #ffffff !important;
        }
    </style>

</head>
    <body class="light"> 

    <header class="site-header text-gray-800 sticky top-0 z-10">
        <nav class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center relative">
            <a href="{{ url_for('index') }}" class="site-logo text-2xl font-extrabold">
                POCHITO
            </a>
            
            <div class="space-x-6 flex items-center text-sm font-medium">
                
                <a href="{{ url_for('productos_carnes') }}" class="nav-link">Todas las Carnes</a>

                <div class="relative group">
                    <button class="nav-link focus:outline-none">Tipos de carnes</button>
                    
                    <div class="absolute left-0 mt-0 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 z-20 overflow-hidden">
                        <a href="{{ url_for('categoria_res') }}" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Carne de Res/Vacuno</a>
                        <a href="{{ url_for('categoria_pollo') }}" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Carne de Pollo</a>
                        <a href="{{ url_for('categoria_cerdo') }}" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Carne de Cerdo</a>
                        <a href="{{ url_for('categorias') }}" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Otras Carnes Rojas</a>
                    </div>
                </div>

                <div class="relative group">
                    <button class="nav-link focus:outline-none">Todos para Asar</button>
                    
                    <div class="absolute left-0 mt-0 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 z-20 overflow-hidden">
                        <a href="{{ url_for('utensilios') }}#cuchillos" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Cuchillos y Hachas</a>
                        <a href="{{ url_for('utensilios') }}#sartenes" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Sartenes y Ollas</a>
                        <a href="{{ url_for('utensilios') }}#asado" class="block px-4 py-2 text-gray-800 dark:text-gray-200 hover:bg-red-500 hover:text-white">Pinzas y Tenedores</a>
                        <div class="h-px bg-gray-200 dark:bg-gray-600 my-1"></div>
                        <a href="{{ url_for('utensilios') }}" class="block px-4 py-2 text-red-600 font-bold hover:bg-red-50 hover:text-red-700">Ver todos los utensilios</a>
                    </div>
                </div>
                
                <a href="{{ url_for('acerca_de') }}" class="nav-link">Mas de nosotros</a>
                <a href="{{ url_for('login') }}" class="nav-link">Iniciar Sesi√≥n</a>

                
                <div id="theme-toggle" class="toggle-switch ml-4"></div>

                <button onclick="toggleCarrito()" class="ml-4 btn-primary px-4 py-2 rounded shadow hover:opacity-95 text-base">
                    üõí
                </button>
            </div>
        </nav>
    </header>

    <main class="flex-grow p-6">
        <div class="max-w-7xl mx-auto">
            {% block content %}{% endblock %}
        </div>
    </main>

    <footer class="site-footer text-left p-10 mt-auto">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6 text-sm text-white">
            <div>
                <div class="font-bold mb-2">HORARIOS</div>
                <div class="text-gray-300">Lun - Sab: 8am - 6pm</div>
            </div>
            <div>
                <div class="font-bold mb-2">PRODUCTOS</div>
                <div class="text-gray-300"><a href="{{ url_for('productos_carnes') }}" class="hover:underline">Todas las Carnes</a></div>
            </div>
            <div>
                <div class="font-bold mb-2">CONTACTO</div>
                <div class="text-gray-300">+51 987 654 321</div>
            </div>
        </div>
        <div class="max-w-7xl mx-auto mt-8 border-t border-white/10 pt-6 text-center text-xs text-gray-300">
            &copy; {{ now().year }} Carnicer√≠a Pochito. Todos los derechos reservados.
        </div>
    </footer>

    <div id="sidebar-carrito" 
         class="fixed top-0 right-0 w-80 h-full bg-white dark:bg-gray-700 shadow-2xl transform translate-x-full transition-transform duration-300 z-50">
        <div class="p-4 flex justify-between items-center border-b dark:border-gray-600">
            <h2 class="text-xl font-bold text-gray-800 dark:text-gray-100">Tu Carrito</h2>
            <button onclick="toggleCarrito()" class="text-red-600 text-2xl hover:text-red-800">‚úñ</button>
        </div>
        <div id="carrito-lista" class="p-4 overflow-y-auto h-[calc(100%-120px)] text-gray-800 dark:text-gray-200">
            <p class="text-gray-500">El carrito est√° vac√≠o.</p>
        </div>
        <div class="p-4 border-t dark:border-gray-600">
            <a href="{{ url_for('pago') }}" 
               class="w-full inline-block text-center bg-green-600 text-white py-2 rounded hover:bg-green-800 transition duration-150">
                Ir a pagar
            </a>
        </div>
    </div>

    <script>
        // L√≥gica de Carrito (deber√≠as tenerla en static/js/carrito.js y aqu√≠)
        function toggleCarrito() {
            const sidebar = document.getElementById("sidebar-carrito");
            sidebar.classList.toggle("translate-x-full");
        }
        function agregarAlCarrito(id, nombre, precio) {
            alert(`A√±adido al carrito: ${nombre} - S/. ${precio}`);
            // Aqu√≠ ir√≠a la l√≥gica real para a√±adir al almacenamiento local/sesi√≥n
        }

        // L√≥gica de Dark Mode robusta
        (function(){
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;

            function setTheme(name){
                if(name === 'dark'){
                    body.classList.add('dark');
                    body.classList.remove('light');
                    themeToggle.classList.add('dark','active');
                } else {
                    body.classList.remove('dark');
                    body.classList.add('light');
                    themeToggle.classList.remove('dark','active');
                }
            }

            // Detect system preference
            const systemPrefDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

            document.addEventListener('DOMContentLoaded', () => {
                const saved = localStorage.getItem('theme');
                if(saved){
                    setTheme(saved);
                } else {
                    setTheme(systemPrefDark ? 'dark' : 'light');
                }
            });

            // click + keyboard (Enter/Space)
            if(themeToggle){
                themeToggle.setAttribute('role','button');
                themeToggle.setAttribute('tabindex','0');
                themeToggle.addEventListener('click', toggle);
                themeToggle.addEventListener('keydown', function(e){ if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle(); } });
            }

            function toggle(){
                const isDark = body.classList.contains('dark');
                const next = isDark ? 'light' : 'dark';
                setTheme(next);
                try{ localStorage.setItem('theme', next); } catch(e){}
            }
        })();

    </script>
</body>
</html>